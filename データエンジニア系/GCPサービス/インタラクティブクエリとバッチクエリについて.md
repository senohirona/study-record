# what
BQのクエリで存在するインタラクティブクエリとバッチクエリについてそれぞれドキュメントを読んでわかったことを記載する

# インタラクティブクエリ・バッチクエリ
BQのクエリにはインタラクティブクエリとバッチクエリの2種類が存在している
[クエリの種類](https://cloud.google.com/bigquery/docs/query-overview?hl=jahttps://cloud.google.com/bigquery/docs/query-overview?hl=ja)

> BigQuery にデータを読み込んだ後に、テーブル内のデータをクエリできます。BigQuery は次の 2 種類のクエリをサポートします。
インタラクティブ クエリ
バッチクエリ

※ デフォルトではインタラクティブクエリが実行される

## インタラクティブクエリ
オンデマンドクエリとも言う。デフォルトで実行されるのはこちら
インタラクティブ(オンデマンド)という言葉通り、ユーザーがクエリをコンソール画面などから実行ボタンを押すとすぐに処理が実行される。

ただし、インタラクティブクエリには1日やプロジェクト毎に利用上限が設けられている
[割当と上限(クエリジョブ、の項目内容を参照)](https://cloud.google.com/bigquery/quotas?hl=ja)

例)
- インタラクティブクエリの同時実行上限は100件
- クエリの実行時間は最長6時間まで
- オンデマンド料金における1プロジェクトの同時実行スロットは最大2000まで
    - スロットは、SQL クエリの実行に必要な演算能力の単位で重い処理をするクエリが実行されるとその単位が増える。スロット数はプロジェクト全体に影響し、他のクエリが同時実行していた場合、そのクエリの処理にも影響を及ぼすことがある

## バッチクエリ
ユーザーが実行ボタンを押してすぐに実行されるのではなく、クエリを一旦キューに格納し、BQでクエリを実行するためのリソースが空いたら実行されるクエリのこと。
24時間以内に実行されなかった場合はインタラクティブクエリとして実行される。

バッチクエリはインタラクティブクエリとは違い、利用上限が設けられていない。
また、リソースが空いたタイミングで実行されるので、他で実行されているクエリに影響を及ぼすことは少ない。

処理が重めのクエリや、「実行はするが今すぐではなくても良い」という場合にはバッチクエリを用いると良い。

# 参考資料
[インタラクティブクエリとバッチクエリのジョブ実行](https://cloud.google.com/bigquery/docs/running-queries?hl=ja#batch)
[スロット](https://cloud.google.com/bigquery/docs/slots?hl=ja-JP)
[割当と上限](https://cloud.google.com/bigquery/quotas?hl=ja)

